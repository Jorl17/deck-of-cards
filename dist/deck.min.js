"use strict";var Deck=function(){function n(n,e){var o=Date.now(),r=o+n,u=r+e,i={start:r,end:u};k.push(i),x||(x=!0,requestAnimationFrame(t));var a={start:function(n){return i.startcb=n,a},progress:function(n){return i.progresscb=n,a},end:function(n){return i.endcb=n,a}};return a}function t(){var n=Date.now();if(!k.length)return void(x=!1);for(var e,o=0;o<k.length;o++)if(e=k[o],!(n<e.start)){e.started||(e.started=!0,e.startcb&&e.startcb());var r=(n-e.start)/(e.end-e.start);e.progresscb&&e.progresscb(1>r?r:1),n>e.end&&(e.endcb&&e.endcb(),k.splice(o--,1))}requestAnimationFrame(t)}function e(n){if("undefined"!=typeof E[n])return E[n];if("undefined"!=typeof I[n])return E[n]=n,n;for(var t,e=n[0].toUpperCase()+n.slice(1),o=["webkit","moz","Moz","ms","o"],r=0,u=o.length;u>r;r++)if(t=o[r]+e,"undefined"!=typeof I[t])return E[n]=t,t}function o(n,t,e){return"undefined"!=typeof b||(b=r()),e=e||0,b?"translate3d("+n+", "+t+", "+e+")":"translate("+n+", "+t+")"}function r(){var n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(!n)return!1;var t=e("transform"),o=document.createElement("p");return document.body.appendChild(o),o.style[t]="translate3d(1px,1px,1px)",b=o.style[t],b=null!=b&&b.length&&"none"!==b,document.body.removeChild(o),b}function u(n){return document.createElement(n)}function i(t,r){function i(n){n.card&&n.card(D)}function l(n){function t(n){I&&("mousemove"===n.type?(u.x=n.clientX,u.y=n.clientY):(u.x=n.touches[0].clientX,u.y=n.touches[0].clientY),C.style[x]=o(Math.round(D.x+u.x-r.x)+"px",Math.round(D.y+u.y-r.y)+"px")+(D.rot?" rotate("+D.rot+"deg)":""))}function e(n){E&&Date.now()-i<200&&D.setSide("front"===D.side?"back":"front"),"mouseup"===n.type?(d(window,"mousemove",t),d(window,"mouseup",e)):(d(window,"touchmove",t),d(window,"touchend",e)),I&&(D.x=D.x+u.x-r.x,D.y=D.y+u.y-r.y)}var r={},u={},i=Date.now();n.preventDefault(),"mousedown"===n.type?(r.x=u.x=n.clientX,r.y=u.y=n.clientY,s(window,"mousemove",t),s(window,"mouseup",e)):(r.x=u.x=n.touches[0].clientX,r.y=u.y=n.touches[0].clientY,s(window,"touchmove",t),s(window,"touchend",e)),I&&(C.style[x]=o(D.x+"px",D.y+"px")+(D.rot?" rotate("+D.rot+"deg)":""),C.style.zIndex=M++)}function p(n){n.appendChild(C),D.$root=n}function m(){D.$root&&D.$root.removeChild(C),D.$root=null}function y(n){"front"===n?("back"===D.side&&C.removeChild(q),D.side="front",C.appendChild(S),D.setRankSuit(D.rank,D.suit)):("front"===D.side&&C.removeChild(S),D.side="back",C.appendChild(q),C.setAttribute("class","card"))}var v;arguments.length>=2?v=c(arguments[0]+" of "+arguments[1]):"string"==typeof t?v=c(t):"number"==typeof t&&(v=t),M++;var h,x=e("transform"),k=v%13+1,b=v/13|0,w=(52-v)/4,C=u("div"),S=u("div"),q=u("div"),I=!1,E=!1,D={i:v,rank:k,suit:b,pos:v,$el:C,mount:p,unmount:m,setSide:y},A=g.modules;S.classList.add("face"),q.classList.add("back"),C.style[x]=o(-w+"px",-w+"px"),D.x=-w,D.y=-w,D.z=w,D.rot=0,D.setSide("back"),s(C,"mousedown",l),s(C,"touchstart",l);for(h in A)i(A[h]);return D.animateTo=function(t){var e,r,u,i,a,c,f=t.delay,s=t.duration,d=t.x,l=void 0===d?D.x:d,p=t.y,m=void 0===p?D.y:p,y=t.rot,v=void 0===y?D.rot:y,h=t.ease,g=t.onStart,k=t.onProgress,b=t.onComplete;n(f,s).start(function(){e=D.x||0,r=D.y||0,u=D.rot||0,g&&g()}).progress(function(n){var t=T[h||"cubicInOut"](n);i=l-e,a=m-r,c=v-u,k&&k(n,t),D.x=e+i*t,D.y=r+a*t,D.rot=u+c*t,C.style[x]=o(D.x+"px",D.y+"px")+(D.rot?"rotate("+D.rot+"deg)":"")}).end(function(){b&&b()})},D.setRankSuit=function(n,t){var e=f(t);C.setAttribute("class","card "+e+" rank"+n)},D.getName=function(){return a(D.rank,D.suit)},D.getRank=function(){return a(D.rank,D.suit).split("of")[0].trim()},D.setRankSuit(k,b),D.enableDragging=function(){I||(I=!0,C.style.cursor="move")},D.enableFlipping=function(){E||(E=!0)},D.disableFlipping=function(){E&&(E=!1)},D.disableDragging=function(){I&&(I=!1,C.style.cursor="")},D}function a(n,t){return 4===t?"Joker":D[n-1]+" of "+f(t)}function c(n){var t=n.split("of").map(function(n){return n.trim().toUpperCase()});if(1===t.length)return"JOKER"===t[0]?52:void 0;if(!(t.length>2)){var e,o=A.indexOf(t[0])+1;switch(t[1]){case"SPADES":e=0;break;case"HEARTS":e=1;break;case"CLUBS":e=2;break;case"DIAMONDS":e=3;break;default:e=4}var r=13*e+o-1;return r}}function f(n){return 0===n?"spades":1===n?"hearts":2===n?"clubs":3===n?"diamonds":"joker"}function s(n,t,e){n.addEventListener(t,e)}function d(n,t,e){n.removeEventListener(t,e)}function l(n){var t=Math.round(Math.random())?-1:1;return t*n}function p(n){for(var t,e,o=n.length-1;o;o--)t=Math.random()*o|0,e=n[o],n[o]=n[t],n[t]=e;return n}function m(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}function y(n){return n*Math.PI/180}function v(n){function t(n){return function(){var t=this,o=arguments;e(function(e){n.apply(t,r.concat.apply(e,o))})}}function e(n){n&&(u.push(n),1===u.length&&o())}function o(){u[0](function(n){if(n)throw n;u=u.slice(1),u.length&&o()})}var r=Array.prototype,u=[];return n.queue=e,n.queued=t,n}function h(n){function t(n,t,e){u[n]||(u[n]=[]),u[n].push({cb:t,ctx:e})}function e(n,t,e){u[n]||(u[n]=[]),u[n].push({cb:t,ctx:e,once:!0})}function o(n){var t=this,e=Array.prototype.slice(arguments,1),o=u[n]||[];o.filter(function(n){return n.cb.apply(t,e),!n.once})}function r(n,t){return n?t?void(u[n]=u[n].filter(function(n){return n.cb!==t})):void(u[n]=[]):void(u={})}n||(n={});var u={};return n.on=t,n.one=e,n.off=r,n.trigger=o,n}function g(n){function t(n){a=n,a.appendChild(d)}function e(){a.removeChild(d)}function o(n){n.deck&&n.deck(l)}var r;n=n||!1,"boolean"==typeof n?r={jokers:n,numDecks:1}:(r=n||{},r.jokers=r.jokers||!1,r.numDecks=r.numDecks||1);var a,c,f=r.jokers?55:52,s=new Array(r.numDecks*f),d=u("div"),l=h({mount:t,unmount:e,cards:s,$el:d}),p=g.modules;v(l);for(c in p)o(p[c]);d.classList.add("deck");for(var m,y=0;y<r.numDecks;y++)for(var x=1;f>=x;x++)s[y*f+x-1]=m=i(x-1),m.mount(d);return l}var x,k=[];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});var b,w,C,S,q,I=document.createElement("p").style,E={},M=0,D=["Ace","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Jack","Queen","King"],A=D.map(function(n){return n.toUpperCase()}),T={linear:function(n){return n},quadIn:function(n){return n*n},quadOut:function(n){return n*(2-n)},quadInOut:function(n){return.5>n?2*n*n:-1+(4-2*n)*n},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return.5>n?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},quartIn:function(n){return n*n*n*n},quartOut:function(n){return 1- --n*n*n*n},quartInOut:function(n){return.5>n?8*n*n*n*n:1-8*--n*n*n*n},quintIn:function(n){return n*n*n*n*n},quintOut:function(n){return 1+--n*n*n*n*n},quintInOut:function(n){return.5>n?16*n*n*n*n*n:1+16*--n*n*n*n*n}},O={deck:function(n){function t(t){var e=n.cards.filter(function(n){return"front"===n.side}).length/n.cards.length;n.cards.forEach(function(n,t){n.setSide(e>.5?"back":"front")}),t()}n.flip=n.queued(t)}},$={deck:function(n){function t(t,e){var o=n.cards;o.sort(function(n,t){return e?n.i-t.i:t.i-n.i}),o.forEach(function(n,r){n.sort(r,o.length,function(n){n===o.length-1&&t()},e)})}n.sort=n.queued(t)},card:function(n){var t=n.$el;n.sort=function(e,o,r,u){var i=e/4,a=10*e;n.animateTo({delay:a,duration:400,x:-i,y:-150,rot:0,onComplete:function(){t.style.zIndex=e}}),n.animateTo({delay:a+500,duration:400,x:-i,y:-i,rot:0,onComplete:function(){r(e)}})}}},z={deck:function(n){function t(t){var e=n.cards;w=m(),p(e),e.forEach(function(n,o){n.pos=o,n.shuffle(function(n){n===e.length-1&&t()},o)})}n.shuffle=n.queued(t)},card:function(n){var t=n.$el;n.shuffle=function(e,o){var r=o/4,u=2*o;n.animateTo({delay:u,duration:200,x:l(40*Math.random()+20)*w/16,y:-r,rot:0}),n.animateTo({delay:200+u,duration:200,x:-r,y:-r,rot:0,onStart:function(){t.style.zIndex=o},onComplete:function(){e(o)}})}}},F={deck:function(n){function t(t){var e=n.cards,o=e.length;C=m(),e.slice(-5).reverse().forEach(function(n,e){n.poker(e,o,function(e){n.setSide("front"),4===e&&t()})})}n.poker=n.queued(t)},card:function(n){var t=n.$el;n.poker=function(e,o,r){var u=250*e;n.animateTo({delay:u,duration:250,x:Math.round(70*(e-2.05)*C/16),y:Math.round(-110*C/16),rot:0,onStart:function(){t.style.zIndex=o-1+e},onComplete:function(){r(e)}})}}},P={deck:function(t){function e(e){var o=t.cards;o.forEach(function(t,r){t.setSide("front"),t.intro(r,function(r){n(250,0).start(function(){t.setSide("back")}),r===o.length-1&&e()})})}t.intro=t.queued(e)},card:function(n){var t=e("transform"),r=n.$el;n.intro=function(e,u){var i=500+10*e,a=e/4;r.style[t]=o(-a+"px","-250px"),r.style.opacity=0,n.x=-a,n.y=-250-a,n.rot=0,n.animateTo({delay:i,duration:1e3,x:-a,y:-a,onStart:function(){r.style.zIndex=e},onProgress:function(n){r.style.opacity=n},onComplete:function(){r.style.opacity="",u&&u(e)}})}}},L={deck:function(n){function t(t){var e=n.cards,o=e.length;S=m(),e.forEach(function(n,r){n.fan(r,o,function(n){n===e.length-1&&t()})})}n.fan=n.queued(t)},card:function(n){var t=n.$el;n.fan=function(e,o,r){var u=e/4,i=10*e,a=e/(o-1)*260-130;n.animateTo({delay:i,duration:300,x:-u,y:-u,rot:0}),n.animateTo({delay:300+i,duration:300,x:55*Math.cos(y(a-90))*S/16,y:55*Math.sin(y(a-90))*S/16,rot:a,onStart:function(){t.style.zIndex=e},onComplete:function(){r(e)}})}}},R={deck:function(n){function t(t){var e=n.cards;q=m(),e.forEach(function(n,o){n.bysuit(function(n){n===e.length-1&&t()},o)})}n.bysuit=n.queued(t)},card:function(n){var t=n.rank,e=n.suit;n.bysuit=function(o,r){var u=10*r;n.animateTo({delay:u,duration:400,x:-Math.round(8*(6.75-t)*q/16),y:-Math.round(92*(1.5-e)*q/16),rot:0,onComplete:function(){o(r)}})}}};return g.animationFrames=n,g.ease=T,g.modules={bysuit:R,fan:L,intro:P,poker:F,shuffle:z,sort:$,flip:O},g.Card=i,g.prefix=e,g.translate=o,g}();